Initially, (on line 21) I mapped each line of the file to the three members of the class Edge, declared on line 8, and converted to dataframe. Then I filtered out the edges that had weights less than 10 by using filter function on the dataframe. Then I computed the averageOutgoingWeights by applying the groupBy clause on the source of the weightsLessThanTen dataframe, and used the agg clause to apply the avg function on the grouped weights for each source, and then selected the source and the avgWeights as the first dataframe declared on line 25. Similarly I computed the averageIncomingWeights by grouping together the targets and taking the average of all incoming weights for each target. This appears on line 26. Next, I joined averageOutgoingWeights with averageIncomingWeights on the node of the two dataframes and took the source along with the difference between the weights as output. 
